import java.util.Scanner;

public class Main {
    public static int[][] estudiantes = new int[1][100];
    public static String[][] datosEstudiantes = new String[3][100];
    public static int[][] notasExPractProm = new int[9][100];
    public static String[] condicionesEstudiantes = new String[100];
    public static int numEstudiantes = 0;
    public static int numNotas = 0;

    public static void registrarEstudiantes() {
        boolean sw = true;
        Scanner sc = new Scanner(System.in);
        while (sw) {
            System.out.println("\nRegistro de estudiantes");
            System.out.println("======================\n");
            System.out.println("Ingrese DNI del estudiante: ");
            int dni = sc.nextInt();

            // Verificar si el DNI ya existe en la matriz de estudiantes
            boolean dniExiste = false;
            for (int i = 0; i < numEstudiantes; i++) {
                if (estudiantes[0][i] == dni) {
                    dniExiste = true;
                    System.out.println("El DNI ingresado ya existe. Intente nuevamente.");
                    break;
                }
            }

            if (!dniExiste) {
                System.out.println("Ingrese Nombre del Estudiante");
                String nombre = sc.next();
                int programa = sc.nextInt();
                String turno = sc.next();

                estudiantes[0][numEstudiantes] = dni;
                datosEstudiantes[0][numEstudiantes] = nombre;
                datosEstudiantes[1][numEstudiantes] = programaEstu(programa);
                datosEstudiantes[2][numEstudiantes] = turno;

                numEstudiantes++;

                System.out.println("\nEstudiante registrado correctamente\n");
            }

            System.out.println("Desea agregar otro estudiante (SI/NO)");
            String respuesta = sc.next();
            if (respuesta.equalsIgnoreCase("no")) {
                sw = false;
            }
        }
    }

    public static void registrarNotas() {
        boolean sw = true;
        Scanner sc = new Scanner(System.in);
        while (sw) {
            int dni = sc.nextInt();

            // Verificar si el estudiante ya tiene notas registradas
            boolean notasRegistradas = false;
            for (int i = 0; i < numNotas; i++) {
                if (notasExPractProm[0][i] == dni) {
                    notasRegistradas = true;
                    System.out.println("El estudiante ya tiene notas registradas. Ingrese otro DNI.");
                    break;
                }
            }

            if (!notasRegistradas) {
                int ex1 = sc.nextInt();
                int ex2 = sc.nextInt();
                int pr1 = sc.nextInt();
                int pr2 = sc.nextInt();
                int pr3 = sc.nextInt();
                int pr4 = sc.nextInt();
                int promedio = promedioEstu(ex1, ex2, pr1, pr2, pr3, pr4);
                String condicion = condicionEstu(promedio);

                notasExPractProm[0][numNotas] = dni;
                notasExPractProm[1][numNotas] = ex1;
                notasExPractProm[2][numNotas] = ex2;
                notasExPractProm[3][numNotas] = pr1;
                notasExPractProm[4][numNotas] = pr2;
                notasExPractProm[5][numNotas] = pr3;
                notasExPractProm[6][numNotas] = pr4;
                notasExPractProm[7][numNotas] = promedio;
                condicionesEstudiantes[numNotas] = condicion;

                numNotas++;

                System.out.println("\nNotas del Estudiante registrado correctamente\n");
            }

            System.out.println("Desea agregar otro estudiante (SI/NO)");
            String respuesta = sc.next();
            if (respuesta.equalsIgnoreCase("no")) {
                sw = false;
            }
        }
    }

    public static String programaEstu(int programa) {
        switch (programa) {
            case 1:
                return "ADM";
            case 2:
                return "ATI";
            case 3:
                return "CON";
            case 4:
                return "ELI";
            case 5:
                return "ELO";
            case 6:
                return "ETE";
            case 7:
                return "MAU";
            case 8:
                return "MEP";
            default:
                return "";
        }
    }

    public static int promedioEstu(int ex1, int ex2, int pr1, int pr2, int pr3, int pr4) {
        int promedio = (int) (0.7 * ((ex1 + ex2) / 2) + 0.3 * ((pr1 + pr2 + pr3 + pr4) / 4));
        return promedio;
    }

    public static String condicionEstu(int promedio) {
        if (promedio >= 12.5) {
            return "Aprobado";
        } else if (promedio < 12.5 && promedio > 10) {
            return "Recuperacion";
        } else {
            return "Desaprobado";
        }
    }
    public static void verDatos() {
        Scanner sc = new Scanner(System.in);
        System.out.println("Ingrese DNI del estudiante: ");
        int dni = sc.nextInt();

        String estudianteEncontrado = null;
        String notasEstudiante = null;

        for (int i = 0; i < numEstudiantes; i++) {
            if (estudiantes[0][i] == dni) {
                estudianteEncontrado = datosEstudiantes[0][i];

                for (int j = 0; j < numNotas; j++) {
                    if (notasExPractProm[0][j] == dni) {
                        notasEstudiante = condicionesEstudiantes[j];
                        if (estudianteEncontrado != null && notasEstudiante != null) {
                            System.out.println("Datos del estudiante:");
                            System.out.println("DNI: " + dni);
                            System.out.println("Nombres: " + estudianteEncontrado);
                            System.out.println("Programa de estudios: " + datosEstudiantes[1][i]);
                            System.out.println("Turno: " + datosEstudiantes[2][i]);
                        }
                    }
                }
                for (int k = 0; k < numNotas; k++) {
                    if (notasExPractProm[0][k] == dni) {
                        System.out.println("Promedio: " + notasExPractProm[7][k]);
                        System.out.println("Condición: " + notasEstudiante);
                        break;
                    }
                }
            }
            else {
                System.out.println("Estudiante no encontrado.");}
        }
    }


    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        boolean sw = true;
        while (sw) {
            System.out.println("---INTRANET---");
            System.out.println("===============\n");
            System.out.println("1.- Registrar Estudiantes");
            System.out.println("2.- Registrar Notas de Estudiantes");
            System.out.println("3.- Ver datos del estudiante");
            System.out.println("4.- Listar estudiantes por programa");
            System.out.println("5.- Ver porcentaje de estudiantes aprobados por programa");
            System.out.println("6.- Lista de estudiantes que van a recuperación por programa");
            System.out.println("7.- Salir");
            System.out.println("================\n");
            System.out.print("\nIngresa una opcion (1-7): ");
            int n = sc.nextInt();
            switch (n) {
                case 1:
                    registrarEstudiantes();
                    break;
                case 2:
                    registrarNotas();
                    break;
                case 3:
                    verDatos();
                    break;
                case 4:
                    ;
                    break;
                case 5:
                    ;
                    break;
                case 6:
                    ;
                    break;
                case 7:
                    sw = false;
                    System.out.println("\n¡Gracias!");
                    break;
                default:
                    System.out.println("Error: Opción inválida");
                    break;
            }
        }
    }
}











public static void listar_Estudiantes() {
        System.out.println("Listado de estudiantes:");

        Scanner sc = new Scanner(System.in);
        System.out.println("Ingrese el número del programa de estudios (1-8): ");
        int programa = sc.nextInt();
        String programaNombre = programaEstu(programa);
        System.out.printf("%8s\t%10s\t%8s\t%1s\t%s\n", "DNI", "NOMBRE", "PROGRAMA", "TURNO", "PROMEDIO");
        for (int i = 0; i < numEstudiantes; i++) {
            int dni = estudiantes[0][i];
            String nombre = datosEstudiantes[0][i];
            String programaEstudio = datosEstudiantes[1][i];
            String turno = datosEstudiantes[2][i];
            int promedio = 0;

            if (programaEstudio.equals(programaNombre)) {
                // Buscar el promedio del estudiante
                for (int j = 0; j < numNotas; j++) {
                    if (notasExPractProm[0][j] == dni) {
                        promedio = notasExPractProm[7][j];
                        break;
                    }
                }

                System.out.printf("%8d\t", dni);
                System.out.printf("%10s\t", nombre);
                System.out.printf("%8s\t", programaEstudio);
                System.out.printf("%1s\t", turno);
                System.out.println(promedio);
            }
        }
    }









 public static void lista_recuperacion() {
        Scanner sc = new Scanner(System.in);
        System.out.println("Ingrese programa de estudios (1-8): ");
        int programa = sc.nextInt();
        String programa_nom = programaEstu(programa);

        System.out.println("Estudiantes en recuperación en el programa " + programaEstu(programa) + ":");
        boolean estudiantesEnRecuperacion = false;

        for (int i = 0; i < numNotas; i++) {
            if (datosEstudiantes[1][i] == programa_nom && condicionesEstudiantes[i].equals("Recuperacion")) {
                System.out.println("DNI: " + estudiantes[0][i]);
                System.out.println("Nombres: " + datosEstudiantes[0][i]);
                estudiantesEnRecuperacion = true;
            }
        }

        if (!estudiantesEnRecuperacion) {
            System.out.println("No se encontraron estudiantes en recuperación en el programa de estudios especificado.");
        }
    }